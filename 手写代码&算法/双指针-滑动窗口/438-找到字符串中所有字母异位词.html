<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
  <script>
    /**
     * https://leetcode.cn/problems/find-all-anagrams-in-a-string/solutions/9749/hua-dong-chuang-kou-tong-yong-si-xiang-jie-jue-zi-/?envType=study-plan-v2&envId=top-100-liked
     * 
     * é¢˜æ„æ€ä¹ˆç†è§£ï¼Ÿ
     *  - å­—æ¯å¼‚ä½è¯ï¼šå³ã€Œå­—æ¯ç›¸åŒï¼Œä½†é¡ºåºä¸åŒã€çš„å­—ç¬¦ä¸²ã€‚
     *    - æ¯”å¦‚ p = "abc"ï¼Œé‚£ä¹ˆå®ƒçš„å¼‚ä½è¯åŒ…æ‹¬ "abc", "acb", "bac", "bca", "cab", "cba"ã€‚
     *  - ç›®æ ‡ï¼šåœ¨ s ä¸­æ‰¾åˆ°æ‰€æœ‰é•¿åº¦ç­‰äº p.length çš„å­ä¸²ï¼Œå¦‚æœè¿™ä¸ªå­ä¸²æ˜¯ p çš„ä¸€ä¸ªå¼‚ä½è¯ï¼Œå°±æŠŠå®ƒçš„èµ·å§‹ä¸‹æ ‡å­˜èµ·æ¥ã€‚
     * 
     * ä¸¾ä¾‹ï¼š
     *  s = "cbaebabacd", p = "abc"
     *  - s[0..2] = "cba" â†’ æ˜¯ "abc" çš„å¼‚ä½è¯ â†’ èµ·å§‹ä¸‹æ ‡ 0
     *  - s[6..8] = "bac" â†’ ä¹Ÿæ˜¯ "abc" çš„å¼‚ä½è¯ â†’ èµ·å§‹ä¸‹æ ‡ 6
     *  ğŸ‘‰ æ‰€ä»¥ç­”æ¡ˆæ˜¯ [0, 6]
     */

    let s = "cbaebabacd";
    let p = "abc";

    var findAnagrams = function(s, p) {
      let need = {};
      let window = {};
      for (let c of p) {
        need[c] = need[c] ? need[c] + 1 : 1;
      }

      let left = 0;
      let right = 0;
      let res = [];
      let valid = 0; // æœ‰å¤šå°‘ä¸ªå­—æ¯é¢‘æ¬¡æ»¡è¶³äº† need

      while (right < s.length) {
        let rightCr = s[right];
        right++;

        if (need[rightCr]) {
          window[rightCr] = window[rightCr] ? window[rightCr] + 1 : 1;
          if (window[rightCr] === need[rightCr]) {
            valid++;
          }
        }

        while (right - left >= p.length) {
          if (valid === Object.keys(need).length) {
            res.push(left); // è¦è¿”å›çš„æ˜¯å­ä¸²çš„èµ·å§‹ä¸‹æ ‡ï¼ˆå·¦ä¸‹æ ‡ï¼‰
          }

          let leftCr = s[left];
          left++;

          if (need[leftCr]) {
            if (window[leftCr] === need[leftCr]) {
              valid--;
            }
            window[leftCr] = window[leftCr] ? window[leftCr] - 1 : 1;
          }
        }

      }
      
      return res;
    };

    console.log(findAnagrams(s, p));
  </script>
</body>
</html>